<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <meta name="author" content="LG Electronics America R&D Center">
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Instructions - LGSVL Simulator</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "Instructions";
    var mkdocs_page_input_path = "autoware-instructions.md";
    var mkdocs_page_url = "/autoware-instructions/";
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script> 
  
  <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-130546445-1', 'lgsvlsimulator.com/docs');
      ga('send', 'pageview');
  </script>
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <!-- edit link, open in new tab -->
        <a href="https://www.lgsvlsimulator.com" class="icon icon-home" target="_blank_"> LGSVL Simulator</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="..">Home</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Quick start</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../getting-started/">Getting started</a>
                </li>
                <li class="">
                    
    <a class="" href="../keyboard-shortcuts/">Keyboard shortcuts</a>
                </li>
                <li class="">
                    
    <a class="" href="../changelog/">Release notes</a>
                </li>
                <li class="">
                    
    <span class="caption-text">User Interface</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../maps-tab/">Maps</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../vehicles-tab/">Vehicles</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../sensor-json-options/">Sensor Parameters</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../clusters-tab/">Clusters</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../simulations-tab/">Simulations</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <a class="" href="../config-and-cmd-line-params/">Configuration File and Command Line Parameters</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Integration with AD</span>
    <ul class="subnav">
                <li class=" current">
                    
    <span class="caption-text">Running with Autoware</span>
    <ul class="subnav">
                <li class="toctree-l3 current">
                    
    <a class="current" href="./">Instructions</a>
    <ul class="subnav">
            
    <li class="toctree-l4"><a href="#general">General</a></li>
    

    <li class="toctree-l4"><a href="#setup">Setup</a></li>
    
        <ul>
        
            <li><a class="toctree-l5" href="#requirements">Requirements</a></li>
        
            <li><a class="toctree-l5" href="#simulator-installation">Simulator Installation</a></li>
        
        </ul>
    

    <li class="toctree-l4"><a href="#launching-autoware-alongside-lgsvl-simulator">Launching Autoware alongside LGSVL Simulator</a></li>
    
        <ul>
        
            <li><a class="toctree-l5" href="#adding-a-vehicle">Adding a Vehicle</a></li>
        
            <li><a class="toctree-l5" href="#adding-an-hd-map">Adding an HD Map</a></li>
        
        </ul>
    

    <li class="toctree-l4"><a href="#copyright-and-license">Copyright and License</a></li>
    

    </ul>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../autoware-json-example/">Sample sensor configuration</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <span class="caption-text">Running with Apollo 5.0</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../apollo5-0-instructions/">Instructions</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../apollo5-0-json-example/">Sample sensor configuration</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <span class="caption-text">Running with Apollo 3.0</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../apollo-instructions/">Instructions</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../apollo-json-example/">Sample sensor configuration</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <span class="caption-text">Ground truth obstacles</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../perception-ground-truth/">Viewing and subscribing to ground truth data</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../ground-truth-json-example/">Sample sensor configuration for data collection</a>
                </li>
    </ul>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Python API</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../python-api/">Python API Guide</a>
                </li>
                <li class="">
                    
    <a class="" href="../api-quickstart-descriptions/">Python API Quickstart Examples</a>
                </li>
                <li class="">
                    
    <a class="" href="../api-example-descriptions/">Python API Use Case Examples</a>
                </li>
                <li class="">
                    
    <a class="" href="../api-how-to-run-scenario/">How to Run a Scenario</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Tutorials</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../openai-gym/">Reinforcement Learning with OpenAI Gym</a>
                </li>
                <li class="">
                    
    <a class="" href="../lane-following/">Deep Learning Lane Following Model</a>
                </li>
                <li class="">
                    
    <a class="" href="../create-ros2-ad-stack/">How to create a simple ROS2-based AD stack</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Advanced</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../map-annotation/">Map Annotation</a>
                </li>
                <li class="">
                    
    <a class="" href="../build-instructions/">Build instructions</a>
                </li>
                <li class="">
                    
    <a class="" href="../add-new-ego-vehicle/">How to add a new ego vehicle</a>
                </li>
                <li class="">
                    
    <a class="" href="../npc-map-navigation/">NPC Map Navigation</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Support</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../faq/">FAQ</a>
                </li>
                <li class="">
                    
    <a class="" href="../contributing/">Contributing</a>
                </li>
    </ul>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">LGSVL Simulator</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
        
          <li>Running with Autoware &raquo;</li>
        
      
        
          <li>Integration with AD &raquo;</li>
        
      
    
    <li>Instructions</li>
    <li class="wy-breadcrumbs-aside">
      
      <!-- edited to not display Github edit link -->
        <a style="display:none;" href="https://github.com/lgsvl/simulator/edit/master/Docs/autoware-instructions.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1><a name="top"></a> Autoware.AI 1.12.0 with LGSVL Simulator</h1>
<p><strong>The software and source code in this repository are intended only for use with LG Automotive Simulator and <em>should not</em> be used in a real vehicle.</strong></p>
<p><a href="../images/full_size_images/autoware-sim.png"><img alt="" src="../images/autoware-sim.png" /></a></p>
<h2> Table of Contents</h2>

<div class="toc">
<ul>
<li><a href="#general">General</a></li>
<li><a href="#setup">Setup</a><ul>
<li><a href="#requirements">Requirements</a><ul>
<li><a href="#installing-docker-ce">Installing Docker CE</a></li>
<li><a href="#installing-nvidia-docker">Installing Nvidia Docker</a></li>
</ul>
</li>
<li><a href="#simulator-installation">Simulator Installation</a></li>
</ul>
</li>
<li><a href="#launching-autoware-alongside-lgsvl-simulator">Launching Autoware alongside LGSVL Simulator</a><ul>
<li><a href="#adding-a-vehicle">Adding a Vehicle</a></li>
<li><a href="#adding-an-hd-map">Adding an HD Map</a></li>
</ul>
</li>
<li><a href="#copyright-and-license">Copyright and License</a></li>
</ul>
</div>
<h2 id="general">General <sub><sup><a href="#top">top</a></sup></sub><a class="headerlink" href="#general" title="Permanent link">#</a></h2>
<p>This guide goes through how to run Autoware.AI with the LG SVL Simulator.</p>
<p>In order to run Autoware with the LGSVL simulator, it is easiest to pull an official Autoware docker image (see <a href="https://gitlab.com/autowarefoundation/autoware.ai/autoware/wikis/Generic-x86-Docker">official guide</a>), but it is also possible to <a href="https://gitlab.com/autowarefoundation/autoware.ai/autoware/wikis/Source-Build">build autoware from source</a>.</p>
<p>Autoware communicates with the simulator using the rosbridge_suite, which provides JSON interfacing with ROS publishers/subscribers. </p>
<h2 id="setup">Setup <sub><sup><a href="#top">top</a></sup></sub><a class="headerlink" href="#setup" title="Permanent link">#</a></h2>
<h3 id="requirements">Requirements <sub><sup><a href="#top">top</a></sup></sub><a class="headerlink" href="#requirements" title="Permanent link">#</a></h3>
<ul>
<li>Linux operating system</li>
<li>Nvidia graphics card</li>
</ul>
<h4 id="installing-docker-ce">Installing Docker CE <sub><sup><a href="#top">top</a></sup></sub><a class="headerlink" href="#installing-docker-ce" title="Permanent link">#</a></h4>
<p>To install Docker CE please refer to the <a href="https://docs.docker.com/install/linux/docker-ce/ubuntu/">official documentation</a>. We also suggest following through with the <a href="https://docs.docker.com/install/linux/linux-postinstall/">post installation steps</a>.</p>
<h4 id="installing-nvidia-docker">Installing Nvidia Docker <sub><sup><a href="#top">top</a></sup></sub><a class="headerlink" href="#installing-nvidia-docker" title="Permanent link">#</a></h4>
<p>Before installing nvidia-docker make sure that you have an appropriate Nvidia driver installed. To test if nvidia drivers are properly installed enter <code>nvidia-smi</code> in a terminal. If the drivers are installed properly an output similar to the following should appear.</p>
<pre><code>    +-----------------------------------------------------------------------------+
    | NVIDIA-SMI 390.87                 Driver Version: 390.87                    |
    |-------------------------------+----------------------+----------------------+
    | GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
    | Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
    |===============================+======================+======================|
    |   0  GeForce GTX 108...  Off  | 00000000:65:00.0  On |                  N/A |
    |  0%   59C    P5    22W / 250W |   1490MiB / 11175MiB |      4%      Default |
    +-------------------------------+----------------------+----------------------+

    +-----------------------------------------------------------------------------+
    | Processes:                                                       GPU Memory |
    |  GPU       PID   Type   Process name                             Usage      |
    |=============================================================================|
    |    0      1187      G   /usr/lib/xorg/Xorg                           863MiB |
    |    0      3816      G   /usr/bin/gnome-shell                         305MiB |
    |    0      4161      G   ...-token=7171B24E50C2F2C595566F55F1E4D257    68MiB |
    |    0      4480      G   ...quest-channel-token=3330599186510203656   147MiB |
    |    0     17936      G   ...-token=5299D28BAAD9F3087B25687A764851BB   103MiB |
    +-----------------------------------------------------------------------------+
</code></pre>

<h3 id="simulator-installation">Simulator installation <sub><sup><a href="#top">top</a></sup></sub><a class="headerlink" href="#simulator-installation" title="Permanent link">#</a></h3>
<p>Follow the instructions on our simulator Github page <a href="https://github.com/lgsvl/simulator">here</a>.</p>
<h2 id="launching-autoware-alongside-lgsvl-simulator">Launching Autoware alongside LGSVL Simulator <sub><sup><a href="#top">top</a></sup></sub><a class="headerlink" href="#launching-autoware-alongside-lgsvl-simulator" title="Permanent link">#</a></h2>
<p>To launch Autoware, first bring up the Docker container following <a href="https://gitlab.com/autowarefoundation/autoware.ai/autoware/wikis/Generic-x86-Docker#case-1-using-pre-built-autoware-docker-images">these steps</a>.</p>
<p>Once inside the container, run Autoware:</p>
<pre><code>autoware@[MY_DESKTOP]:~$ roslaunch runtime_manager runtime_manager.launch
</code></pre>

<p>A few terminals will open, as well as a GUI for the runtime manager. In the runtime manager, click on the 'Quick Start' tab and load the following launch files from <code>~/shared_dir/autoware-data/BorregasAve/</code> by clicking "Ref" to the right of each text box:</p>
<ul>
<li><code>my_borregas.launch</code></li>
<li><code>my_sensing_simulator.launch</code></li>
<li><code>my_localization.launch</code></li>
<li><code>my_detection.launch</code></li>
</ul>
<p><a href="../images/autoware-runtime-manager.jpg"><img alt="" src="../images/autoware-runtime-manager.jpg" /></a></p>
<p>Click "Map" to load the launch file pertaining to the HD maps. An "Ok" should appear to the right of the "Ref" button when successfully loaded. Then click "Sensing" which brings up rosbridge. </p>
<ul>
<li>Run the LG SVL simulator</li>
<li>Create a Simulation choosing <code>BorregasAve</code> map and <code>Jaguar2015XE (Autoware)</code> or another Autoware compatible vehicle. </li>
<li>Run the created Simulation</li>
</ul>
<p>A vehicle should appear in Borregas Ave in Sunnyvale, CA.</p>
<p>In the Autoware Runtime Manager, continue loading the other launch files - click "Localization" and wait for the time to display to the right of "Ref".</p>
<p>Then click "Rviz" to launch Rviz - the vector map and location of the vehicle in the map should show. </p>
<p>The vehicle may be mis-localized as the initial pose is important for NDT matching. To fix this, click "2D Pose Estimate" in Rviz, then click an approximate position for the vehicle on the map and drag in the direction it is facing before releasing the mouse button. This should allow NDT matching to find the vehicle pose (it may take a few tries).</p>
<p>An alternative would be to use GNSS for an inital pose or for localization but the current Autoware release (1.12.0) does not support GNSS coordinates outside of Japan. Fix for this is available in following pull requests: <a href="https://gitlab.com/autowarefoundation/autoware.ai/utilities/merge_requests/27">utilities#27</a>, <a href="https://gitlab.com/autowarefoundation/autoware.ai/common/merge_requests/20">common#20</a>, <a href="https://gitlab.com/autowarefoundation/autoware.ai/core_perception/merge_requests/26">core_perception#26</a> These are not yet merged in Autoware master.</p>
<p>A basic functionality of Autoware is to follow a prerecorded map while obeying traffic rules. To do this you will need to record a route first. Switch to the <code>Computing</code> tab and check the box for <code>waypoint_saver</code>. Make sure to select an appropriate location and file name by clicking on the <code>app</code> button.</p>
<p>Now you can drive around the map using the keyboard. Once you are satisfied with your route, uncheck the box for <code>waypoint_saver</code> to end the route.</p>
<p>To drive the route using autoware:
- Enable <code>waypoint_loader</code> while making sure the correct route file is selected in the <code>app</code> settings.
- Enable <code>lane_rule</code>, <code>lane_stop</code>, and <code>lane_select</code> to follow traffic rules based on the vector map.
- Enable <code>astar_avoid</code> and <code>velocity_set</code>.
- Enable <code>pure_pursuit</code> and <code>twist_filter</code> to start driving.</p>
<p>The ego vehicle should try to follow the waypoints at the velocity which they were originally recorded at. You can modify this velocity by manually editing the values csv file.</p>
<h3 id="adding-a-vehicle">Adding a Vehicle <sub><sup><a href="#top">top</a></sup></sub><a class="headerlink" href="#adding-a-vehicle" title="Permanent link">#</a></h3>
<p>The default vehicles have the calibration files included in the <a href="https://github.com/lgsvl/autoware-data">LGSVL Autoware Data</a> Github repository. </p>
<p>If not using a default vehicle:</p>
<ol>
<li>Download the appropriate calibration files from <a href="https://content.lgsvlsimulator.com/vehicles/">here</a> if using a vehicle created by LG Silicon Valley Lab</li>
<li>Extract the contents and place them in the <code>shared_dir</code> folder that was created when installing Autoware</li>
<li>Run Autoware and from the Runtime Manager, click the <code>Ref</code> button next to <code>Localization</code> and <code>Detection</code> to browse and select a <code>.launch</code> file</li>
<li>Select the <code>.launch</code> files that were inclued in the <code>.tar</code></li>
</ol>
<h3 id="adding-an-hd-map">Adding an HD Map <sub><sup><a href="#top">top</a></sup></sub><a class="headerlink" href="#adding-an-hd-map" title="Permanent link">#</a></h3>
<p>The default maps have the Vector map files included in the <a href="https://github.com/lgsvl/autoware-data">LGSVL Autoware Data</a> Github repository.</p>
<p>If not using a default vehicle:</p>
<ol>
<li>Download the appropriate HD map from <a href="https://content.lgsvlsimulator.com/vehicles/">here</a> if using a map created by LG Silicon Valley Lab. The folder will be <code>MAPNAME.tar</code></li>
<li>Extract the contents and place them in the <code>shared_dir</code> folder that was created when installing Autoware</li>
<li>Run Autoware and from the Runtime Manager, click the <code>Ref</code> button next to <code>Map</code> to browse to select a <code>.launch</code> file</li>
<li>Select the <code>.launch</code> file that was included in the <code>.tar</code></li>
</ol>
<h2 id="copyright-and-license">Copyright and License <sub><sup><a href="#top">top</a></sup></sub><a class="headerlink" href="#copyright-and-license" title="Permanent link">#</a></h2>
<p>Copyright (c) 2019 LG Electronics, Inc.</p>
<p>This software contains code licensed as described in LICENSE.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../autoware-json-example/" class="btn btn-neutral float-right" title="Sample sensor configuration">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../config-and-cmd-line-params/" class="btn btn-neutral" title="Configuration File and Command Line Parameters"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
      <p>Copyright &copy; 2019 LG Electronics Inc.</p>
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/lgsvl/simulator/" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../config-and-cmd-line-params/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../autoware-json-example/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>

</body>
</html>
